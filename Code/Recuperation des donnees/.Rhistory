#Test de récuperation des données à travers de JSON
#import
library(jsonlite)
#url exemple, testing
# annee2Read<-2013
# urlRATP<-"https://dataratp2.opendatasoft.com/api/records/1.0/search/?dataset=qualite-de-lair-mesuree-dans-la-station-franklin-d-roosevelt&q=&rows=10000&sort=-dateheure&facet=dateheure&refine.dateheure=2018"
# dfAux<-fromJSON(urlRATP)
#boucle pour récupérer les données
urlBase="https://dataratp2.opendatasoft.com/api/records/1.0/search/?dataset=qualite-de-lair-mesuree-dans-la-station-franklin-d-roosevelt&q=&rows=10000&sort=-dateheure&facet=dateheure&refine.dateheure="
donAnnee=list()
#dfAux$records$fields
#lire par an
for (anInd in 2013:2020)
{
print(anInd)
urlRATP=paste(urlBase,anInd,sep="")
source('C:/Formation IA/CEPE/Projet/QAIR/Code/Recuperation des donnees/workingProjet.R', echo=TRUE)
#boucle pour récupérer les données
urlBase="https://dataratp2.opendatasoft.com/api/records/1.0/search/?dataset=qualite-de-lair-mesuree-dans-la-station-franklin-d-roosevelt&q=&rows=10000&sort=-dateheure&facet=dateheure&refine.dateheure="
donAnnee=list()
#lire par an
for (anInd in 2013:2020)
{
print(anInd)
urlRATP=paste(urlBase,anInd,sep="")
donAnnee[[anInd]]<-fromJSON(urlRATP)$records$fields
}
print(anInd)
print(1)
1+1
